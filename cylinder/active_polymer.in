#圆柱内active polymer
variable R equal 20
variable L equal 40
variable N equal 50
variable k equal 10000 #键强度
variable k1 equal 0.1  #wall作用强度
variable kappa equal 1.0 #角作用强度
variable e_lj equal 1.0
variable cutoff1 equal 2.5
variable cutoff2 equal 1.0
variable gamma equal 10
variable damp equal 1.0/v_gamma
variable T equal 1.3-0.1*v_i
variable seed equal 12335
variable i loop 1 12

units          lj
dimension      3
boundary       f f f
atom_style     angle
neighbor       1.0 bin
neigh_modify   every 1 delay 0 check yes

read_data      data.co    

pair_style     lj/cut  2.5
pair_coeff     1 1 1.0 1.0 1.12246 

bond_style     harmonic
bond_coeff     1 ${k} 1.0

angle_style    harmonic
angle_coeff    1 ${kappa} 180

region         area cylinder z 0 0 ${R} -50.0 50.0

group          1 type 1
group          3 id 2:79

timestep       0.001

thermo_style   custom step temp  v_kappa v_T
thermo         5000

dump           1 all custom 5000 active_polymerR=${R}k=${k1}kappa=${kappa}.dump type id x y z 

fix            1 1 langevin 1.5 1.5 ${damp} ${seed} zero yes 
fix            2 all wall/region area harmonic ${k1} ${R} ${R} 

#fix           3 3 addforce v_f[1] v_f[2] v_f[3]

#fix           4 1 nve

label          loop_start
fix            3 1 nvt temp ${T} ${T}  1.0
run            50000
next           i
jump           SELF loop_start
